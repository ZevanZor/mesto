(()=>{"use strict";class e{constructor(e,t){var s,r;r=()=>{this._form.checkValidity()?this._disableSubmitButton():this._enableSubmitButton()},(s="toggleButton")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._form=t,this._inputSelector=e.inputSelector,this._inputErrorClass=e.inputErrorClass,this._errorVisibleClass=e.errorVisibleClass,this._buttonSelector=e.buttonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._button=this._form.querySelector(this._buttonSelector),this._inputs=this._form.querySelectorAll(this._inputSelector)}_showError(e){e.classList.add(this._inputErrorClass),this._errorContainer.classList.add(this._errorVisibleClass),this._errorContainer.textContent=e.validationMessage}_hideError(e){e.classList.remove(this._inputErrorClass),this._errorContainer.classList.remove(this._errorVisibleClass),this._errorContainer.textContent=""}_enableSubmitButton(){this._button.classList.add(this._inactiveButtonClass),this._button.disabled=!0}_disableSubmitButton(){this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=!1}_validateInput(e){this._errorContainer=this._form.querySelector("#error-".concat(e.id)),e.validity.valid?this._hideError(e,this._errorContainer):this._showError(e,this._errorContainer),this.toggleButton()}enableValidation(){this._form.addEventListener("submit",this._submitForm),this._inputs.forEach((e=>{e.addEventListener("input",(()=>{this._validateInput(e)}))})),this.toggleButton()}_submitForm(e){e.preventDefault()}}var t={formSelector:".popup__form",inputSelector:".popup__input",errorSelector:".error-message",errorVisibleClass:"error-message_visible",inputErrorClass:"popup__input_type_error",buttonSelector:".popup__save",inactiveButtonClass:"popup__save_disabled"},s=document.querySelector(".popup_type_image");document.querySelector(".popup__image-card"),s.querySelector(".popup__image-title");class r{constructor(e,t,s){this._name=e.name,this._link=e.link,this._handleCardClick=s,this._template=document.querySelector(t).content.querySelector(".elements__groups")}_likeCard(){this._elementsLike.classList.toggle("elements__like_active")}_deleteCard(){this._elementsClone.remove()}_setEventListeners(){this._elementsDelete.addEventListener("click",(()=>this._deleteCard())),this._elementsLike.addEventListener("click",(()=>this._likeCard())),this._elementsImage.addEventListener("click",(()=>this._handleCardClick()))}_fillCard(){this._elementsImage.src=this._link,this._elementsTitle.textContent=this._name,this._elementsImage.alt=this._name}createCard(){return this._elementsClone=this._template.cloneNode(!0),this._elementsImage=this._elementsClone.querySelector(".elements__image"),this._elementsTitle=this._elementsClone.querySelector(".elements__title"),this._elementsDelete=this._elementsClone.querySelector(".elements__delete"),this._elementsLike=this._elementsClone.querySelector(".elements__like"),this._fillCard(),this._setEventListeners(),this._elementsClone}}class n{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popup.classList.add("popup_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(e){this._popup.querySelector(".popup__close").addEventListener("click",(()=>this.close())),this._popup.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class i extends n{constructor(e,t){super(e),this._callbackSubmitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){return this._values={},this._inputs.forEach((e=>{this._values[e.name]=e.value})),this._values}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(()=>{this._callbackSubmitForm(this._getInputValues())}))}close(){super.close(),this._form.reset()}}var o=document.querySelector(".profile__edit-button"),l=document.querySelector(".popup_type_edit"),a=document.querySelector(".popup__input_type_name"),_=document.querySelector(".popup__input_type_info"),p=l.querySelector(".popup__form"),u=document.querySelector(".popup_type_add-card"),c=document.querySelector(".profile__add-button"),d=new e(t,u.querySelector(".popup__form"));function h(e){return new r(e,".elements__template",(()=>{v.open(e.name,e.link)})).createCard()}new e(t,p).enableValidation(),d.enableValidation(),o.addEventListener("click",(function(){var e=C.getUserInfo(),t=e.name,s=e.job;a.value=t,_.value=s,b.open()})),c.addEventListener("click",(function(){y.open()}));var m=new class{constructor(e,t){var s=e.items,r=e.renderer;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e,t){var s=h(e);m.addItem(s)}},".elements");m.renderItems();var v=new class extends n{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image-card"),this._title=this._popup.querySelector(".popup__image-title")}open(e,t){this._image.src=t,this._title.textContent=e,this._image.alt=e,super.open()}}(".popup_type_image");v.setEventListeners();var b=new i(".popup_type_edit",(e=>{var t=e.name,s=e.info;C.setUserInfo(t,s),b.close()})),y=new i(".popup_type_add-card",(e=>{var t=h({link:e.link,name:e.name});m.addItem(t),y.close(),d.toggleButton()}));b.setEventListeners(),y.setEventListeners();var C=new class{constructor(e){var t=e.nameElementSelector,s=e.jobElementSelector;this._name=document.querySelector(t),this._job=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}setUserInfo(e,t){this._name.textContent=e,this._job.textContent=t}}({nameElementSelector:".profile__title",jobElementSelector:".profile__subtitle"})})();